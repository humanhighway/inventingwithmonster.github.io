{"data":{"markdownRemark":{"html":"<p>“Don’t reinvent the wheel” is sage advice. In production, it’s almost always better to leverage battle-tested software over rolling your own.</p>\n<p>But if you want to <strong>learn</strong>, forget it. Making your own version of existing libraries can not only help you become a better software developer, but also improve your ability to think critically about the software you do consume in production.</p>\n<p>In that spirit, by the end of this post we’re going to better understand the inner-workings of the bedrock of UI animation, the tween, by making one from scratch.</p>\n<h2 id=\"a-what-now\"><a href=\"#a-what-now\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>A what now?</h2>\n<p>A tween! Even if you haven’t heard the term before, if you’ve done UI animation it’s likely you’ve used one before.</p>\n<p>The name of the function can differ. <a href=\"https://greensock.com/\">GreenSock’s TweenMax</a> calls it <code class=\"language-text\">to</code>. <a href=\"https://animejs.com\">Anime</a> calls it <code class=\"language-text\">anime</code>. My own <a href=\"https://popmotion.io\">Popmotion</a> calls it a <code class=\"language-text\">tween</code>.</p>\n<p>But the functionality isn’t exclusive to JavaScript. If you’ve ever written CSS like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">div</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">transition</span><span class=\"token punctuation\">:</span> all 300ms ease-out<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>That’s defining a tween too!</p>\n<p>A tween is just an <strong>animation between two values, over a duration of time</strong>.</p>\n<p>The term originated as a abbreviation for “inbetweening”. It’s a process where a cartoon’s lead illustrators would define the <strong>keyframes</strong> of the animation, and then pass those off to the cheaper labour. They’d fill in the missing frames with transitional illustrations. Inbetweening.</p>\n<p>I first encountered the word “tween” in Flash (ask your parents). Adobe’s skeuomorphic naming of tools meant that on the timeline you’d place keyframes and Flash would tween between those.</p>\n<p>So the term itself is actually an anachronism. In <a href=\"https://facebook.github.io/react-native/docs/animated\">React Native’s Animated</a> they call it a <code class=\"language-text\">timing</code> animation, which might be more immediately obvious to modern readers.</p>\n<p>Back in those Flash days, I used to use Greensock’s TweenMax library to write tween animations. There was something about it that seemed magical, like it was tapping into a special Flash API that I didn’t understand. It was only when I wrote Popmotion that I realised that making animations really is just a matter of changing values gradually, once per frame.</p>\n<h2 id=\"what-well-make\"><a href=\"#what-well-make\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What we’ll make</h2>\n<p>By the end of this post we’ll have a <code class=\"language-text\">tween</code> function that looks like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">tween</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">from</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n  to<span class=\"token punctuation\">:</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span>\n  duration<span class=\"token punctuation\">:</span> <span class=\"token number\">300</span><span class=\"token punctuation\">,</span>\n  onUpdate<span class=\"token punctuation\">:</span> v <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<iframe height=\"400\" style=\"width: 100%;\" scrolling=\"no\" title=\"Write your own tween (completed)\" src=\"//codepen.io/popmotion/embed/preview/LaRxLR/?height=400&theme-id=17364&default-tab=js,result\" frameborder=\"no\" allowtransparency=\"true\" allowfullscreen=\"true\"></iframe>\n<p>The easiest way to follow along with the tutorial is to fork <a href=\"https://codepen.io/popmotion/pen/zbGYxp?editors=0011\">this CodePen</a>. It’s already set up with an open console, modern JavaScript support, and a <code class=\"language-text\">div</code> that we’ll use our completed <code class=\"language-text\">tween</code> function to animate.</p>\n<h2 id=\"the-function\"><a href=\"#the-function\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>The function</h2>\n<p>Let’s start by writing our function. I’m going to call mine <code class=\"language-text\">tween</code> but you can call yours anything. If there’s a name you prefer, <a href=\"https://twitter.com/mattgperry\">answers on a postcard</a>.</p>\n<p>It’s going to take a single argument, a configuration object.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">tween</span><span class=\"token punctuation\">(</span>config <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>This configuration object should be set up with some sensible defaults to make life easier for users of this function.</p>\n<p>In Popmotion I’ve gone with <code class=\"language-text\">from: 0</code> and <code class=\"language-text\">to: 1</code>, because the range <code class=\"language-text\">0</code>-<code class=\"language-text\">1</code> often comes in handy when writing animations and GPU shaders.</p>\n<p>The full extent of its use is beyond the scope of this article but, as <code class=\"language-text\">0</code> represents “none of something” or “zero progress” and <code class=\"language-text\">1</code> represents “all of something” or “completed progress” you can probably imagine that it’s a simple, standard way to think about ranges.</p>\n<p>I also chose a <code class=\"language-text\">duration</code> of <code class=\"language-text\">300</code> milliseconds as I think it strikes a nice balance of being snappy but not abrupt.</p>\n<p>To set these defaults, we can use <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment\">destructuring</a> syntax.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">tween</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token keyword\">from</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> to <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> duration <span class=\"token operator\">=</span> <span class=\"token number\">300</span> <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>You can verify your function is working with these defaults by adding a <code class=\"language-text\">console.log</code> to your function, and then immediately calling it:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">tween</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token keyword\">from</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> to <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> duration <span class=\"token operator\">=</span> <span class=\"token number\">300</span> <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>duration<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">tween</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>The console panel will say <code class=\"language-text\">300</code>. If you pass in your own <code class=\"language-text\">duration</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">tween</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> duration<span class=\"token punctuation\">:</span> <span class=\"token number\">1000</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>It will show that instead.</p>\n<p>That’s the skeleton of our function working, now we need to make it run an animation.</p>\n<h2 id=\"the-animation-loop\"><a href=\"#the-animation-loop\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>The animation loop</h2>\n<p>Remember what “tween” is short for: “inbetweening”. We have our <code class=\"language-text\">from</code> and <code class=\"language-text\">to</code> values, those are our keyframes. So now we need to, over the course of <code class=\"language-text\">duration</code>, generate values that are inbetween those two.</p>\n<p>To do this, we’re going to use the <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame\"><code class=\"language-text\">requestAnimationFrame</code> function</a>. This is a function that allows you to ask the browser to run some code before the next frame is rendered.</p>\n<p>Inside the <code class=\"language-text\">tween</code> function, we’re going to make a new function called <code class=\"language-text\">update</code>. We’re going to run this function once every frame.</p>\n<p>Inside the <code class=\"language-text\">tween</code> function, make a new function called <code class=\"language-text\">update</code>. In it, place a <code class=\"language-text\">console.log</code> so we know it’s running.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">tween</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token keyword\">from</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> to <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> duration <span class=\"token operator\">=</span> <span class=\"token number\">300</span> <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"update!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>At the end of <code class=\"language-text\">tween</code>, use <code class=\"language-text\">requestAnimationFrame</code> to call <code class=\"language-text\">update</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">tween</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token keyword\">from</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> to <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> duration <span class=\"token operator\">=</span> <span class=\"token number\">300</span> <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"update!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span>update<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Now when you call <code class=\"language-text\">tween</code>, your console will ping <code class=\"language-text\">&quot;update!&quot;</code>.</p>\n<p>Most monitors render at 60 frames a second. There’s some edge-cases, for instance when iOS is in low-power mode, Safari runs at 30 frames a second. But to make animation appear smooth, you need to call <code class=\"language-text\">requestAnimationFrame</code> once for every single frame!</p>\n<p>At the end of <code class=\"language-text\">update</code>, add the same line of code again. A <code class=\"language-text\">requestAnimationFrame</code>, calling <code class=\"language-text\">update</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"update!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span>update<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>This will schedule another call to <code class=\"language-text\">update</code> for the <strong>next</strong> frame, thereby starting a frame-synced loop.</p>\n<h2 id=\"calculate-elapsed\"><a href=\"#calculate-elapsed\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Calculate elapsed</h2>\n<p>A <code class=\"language-text\">tween</code> is a duration-based animation, so the key piece of information we need is the progress of the animation, which we derive from the amount of time that’s elapsed.</p>\n<p>The simplest way to do this is to record the time the animation starts, and then every frame measure how much time has elapsed since then.</p>\n<p>To do this, we can use the browser’s <code class=\"language-text\">performance.now</code> function. This returns a timestamp, the number of milliseconds since the page session started.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">tween</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token keyword\">from</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> to <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> duration <span class=\"token operator\">=</span> <span class=\"token number\">300</span> <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> startTime <span class=\"token operator\">=</span> performance<span class=\"token punctuation\">.</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"update!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span>update<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span>update<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">rAF</code> calls the function given to it with a single argument, the timestamp of the current frame. So we can use the difference between that and <code class=\"language-text\">startTime</code> to calculate <code class=\"language-text\">elapsed</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> startTime <span class=\"token operator\">=</span> performance<span class=\"token punctuation\">.</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span>currentTime<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> elapsed <span class=\"token operator\">=</span> currentTime <span class=\"token operator\">-</span> startTime<span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"derive-progress\"><a href=\"#derive-progress\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Derive progress</h2>\n<p>Now that we have an <code class=\"language-text\">elapsed</code> value, we can figure out <code class=\"language-text\">progress</code>. <code class=\"language-text\">progress</code> is a value between <code class=\"language-text\">0</code> and <code class=\"language-text\">1</code>, and as mentioned earlier <code class=\"language-text\">0</code> represents no progress and <code class=\"language-text\">1</code> represents a completed animation.</p>\n<p>The calculation for this is <code class=\"language-text\">elapsed</code> divided by <code class=\"language-text\">duration</code>. Essentially a percentage calculation without multiplying by <code class=\"language-text\">100</code> at the end:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> progress <span class=\"token operator\">=</span> elapsed <span class=\"token operator\">/</span> duration<span class=\"token punctuation\">;</span></code></pre></div>\n<p>To explain, think of an animation of <code class=\"language-text\">1000</code> millisecond duration that has been running for <code class=\"language-text\">500</code> milliseconds:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> progress <span class=\"token operator\">=</span> <span class=\"token number\">500</span> <span class=\"token operator\">/</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 0.5</span></code></pre></div>\n<p><code class=\"language-text\">0.5</code> represents half way through the animation, which is correct.</p>\n<p>We want to clamp <code class=\"language-text\">progress</code> to no greater than <code class=\"language-text\">1</code>, so for this we can use <code class=\"language-text\">Math.min</code>, which returns the smallest of the numbers provided to it:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> progress <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">min</span><span class=\"token punctuation\">(</span>elasped <span class=\"token operator\">/</span> duration<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>We also want to automatically stop the tween when <code class=\"language-text\">progress</code> is <code class=\"language-text\">1</code>, so let’s wrap our self-calling <code class=\"language-text\">rAF</code> with a check that does just that:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span>currentTime<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> elapsed <span class=\"token operator\">=</span> currentTime <span class=\"token operator\">-</span> startTime<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> progress <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">min</span><span class=\"token punctuation\">(</span>elasped <span class=\"token operator\">/</span> duration<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>progress <span class=\"token operator\">&lt;</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span>update<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"calculate-tweened-values\"><a href=\"#calculate-tweened-values\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Calculate tweened values</h2>\n<p>Now we’re ready to use <code class=\"language-text\">progress</code> to calculate our tweened values!</p>\n<p>First, we need to calculate the distance (or the <code class=\"language-text\">delta</code>) between <code class=\"language-text\">to</code> and <code class=\"language-text\">from</code>. We can do this by subtracting <code class=\"language-text\">to</code> from <code class=\"language-text\">from</code> at the start of the <code class=\"language-text\">tween</code> function:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> delta <span class=\"token operator\">=</span> to <span class=\"token operator\">-</span> <span class=\"token keyword\">from</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>This gives us a <code class=\"language-text\">delta</code> value which, when we add back to <code class=\"language-text\">from</code>, will return <code class=\"language-text\">to</code>. By multiplying <code class=\"language-text\">delta</code> with the frame’s <code class=\"language-text\">progress</code> before adding it to <code class=\"language-text\">from</code>, we’ll get the correct value for that frame:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> latest <span class=\"token operator\">=</span> <span class=\"token keyword\">from</span> <span class=\"token operator\">+</span> progress <span class=\"token operator\">*</span> delta<span class=\"token punctuation\">;</span></code></pre></div>\n<p>The way this works is, when we multiply <code class=\"language-text\">delta</code> by <code class=\"language-text\">0</code> (no progress), <code class=\"language-text\">latest</code> will be the same as <code class=\"language-text\">from</code>. When we multiply <code class=\"language-text\">delta</code> by <code class=\"language-text\">1</code> (completed tween) and add that to <code class=\"language-text\">from</code>, we receive <code class=\"language-text\">to</code>.</p>\n<p>Now if you <code class=\"language-text\">console.log(latest)</code>, you can see your tween works!</p>\n<p>Here’s how your function should look:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">tween</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token keyword\">from</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> to <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> duration <span class=\"token operator\">=</span> <span class=\"token number\">300</span> <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> delta <span class=\"token operator\">=</span> to <span class=\"token operator\">-</span> <span class=\"token keyword\">from</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> startTime <span class=\"token operator\">=</span> performance<span class=\"token punctuation\">.</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span>currentTime<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> elapsed <span class=\"token operator\">=</span> currentTime <span class=\"token operator\">-</span> startTime<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> progress <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">min</span><span class=\"token punctuation\">(</span>elapsed <span class=\"token operator\">/</span> duration<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> latest <span class=\"token operator\">=</span> <span class=\"token keyword\">from</span> <span class=\"token operator\">+</span> progress <span class=\"token operator\">*</span> delta<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>progress <span class=\"token operator\">&lt;</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span>update<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span>update<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"animate-the-ball\"><a href=\"#animate-the-ball\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Animate the ball</h2>\n<p>Of course, animations are no good if they don’t animate anything. So we need to provide a way for people to define a render target which, in this case, is going to be the ball <code class=\"language-text\">div</code> on the CodePen.</p>\n<p>Add <code class=\"language-text\">onUpdate</code> to the config:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">tween</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token keyword\">from</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> to <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> duration <span class=\"token operator\">=</span> <span class=\"token number\">300</span><span class=\"token punctuation\">,</span> onUpdate <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></code></pre></div>\n<p>This is going to be a function that a user can configure to fire once every frame.</p>\n<p>On the line after we calculate <code class=\"language-text\">latest</code>, call <code class=\"language-text\">onUpdate</code> with <code class=\"language-text\">latest</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>onUpdate<span class=\"token punctuation\">)</span> <span class=\"token function\">onUpdate</span><span class=\"token punctuation\">(</span>latest<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>After your <code class=\"language-text\">tween</code> function, cache a reference to the <code class=\"language-text\">#ball</code> element.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> ball <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ball\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Now we can define an <code class=\"language-text\">onUpdate</code> property in our call to <code class=\"language-text\">tween</code> that uses its output to change <code class=\"language-text\">opacity</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">tween</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  duration<span class=\"token punctuation\">:</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">,</span>\n  onUpdate<span class=\"token punctuation\">:</span> v <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    ball<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>opacity <span class=\"token operator\">=</span> v<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Success! You can animate any value this way. For instance <code class=\"language-text\">translateX</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">tween</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">from</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n  to<span class=\"token punctuation\">:</span> <span class=\"token number\">300</span><span class=\"token punctuation\">,</span>\n  onUpdate<span class=\"token punctuation\">:</span> v <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    ball<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>transform <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token string\">`translateX(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>v<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px) translateZ(0)`</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"easing\"><a href=\"#easing\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Easing</h2>\n<p>When you animate <code class=\"language-text\">x</code> you might notice something about the motion that feels a little stifled. That’s because we’re doing a <code class=\"language-text\">linear</code> tween, which means <code class=\"language-text\">progress</code> has a linear relationship to time.</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/bce9abc1d93705a059553956a146941f/8a7aa/201902-easing-linear.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 650px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 63.291139240506325%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAABMklEQVQ4y42SwVKDMBCGOflWfXVPPTi9eGKqM9JSkSJQJdZSgexmTVI2AgVqZj52+Tf7J4R4RHTXpfppXA6ALldKWUweQeX0WmGv39MPn9ENNn6kwtdmTmPMO7axVODLNueawRhejexN0Nw4aXakRmvGEBm9ko3xNkMpoadhGw/Y4FqWVz2M26EuWMyIgpRAAhdMl01zbOhJltTt6UbeYU88fh9ptXx0Gptl/zAbNRSioOX9yuZslmJNz/J802zUEBEoWEcE9giJ3mfMZg27k+MwJ2qQEmumP1P9GQwZO0N10S7D5PsgUzFUakO14voU3MMYQ2B0zcZNmMJDGINIBOT7ArL4E5LX3OaM0c6nqtdn8CZvr9Tn2aI025cdFYcve9v0D7dMXexFF73aYqjNMZz/C6Fp2vgzTVM+AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"A graph representing linear easing\"\n        title=\"\"\n        src=\"/static/bce9abc1d93705a059553956a146941f/6b671/201902-easing-linear.png\"\n        srcset=\"/static/bce9abc1d93705a059553956a146941f/f7a0c/201902-easing-linear.png 163w,\n/static/bce9abc1d93705a059553956a146941f/608ba/201902-easing-linear.png 325w,\n/static/bce9abc1d93705a059553956a146941f/6b671/201902-easing-linear.png 650w,\n/static/bce9abc1d93705a059553956a146941f/1ee70/201902-easing-linear.png 975w,\n/static/bce9abc1d93705a059553956a146941f/8a7aa/201902-easing-linear.png 1264w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n      />\n  </span>\n  </a></p>\n<p>In other words, <code class=\"language-text\">progress</code> changes at a constant rate as the animation progresses.</p>\n<p>In the real world, stuff doesn’t often move at a constant rate. It tends to accelerate and/or decelerate.</p>\n<p>We can replicate this kind of motion in a tween using <strong>easing</strong>. Easing functions take a <code class=\"language-text\">progress</code> value and return a new one. For instance, the <code class=\"language-text\">linear</code> easing shown above looks like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">linear</span><span class=\"token punctuation\">(</span>progress<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> progress<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>The precise way an easing function affects <code class=\"language-text\">progress</code> varies, but you can play with different easing curves at <a href=\"http://cubic-bezier.com/#.17,.67,.83,.67\">Lea Verou’s Cubic Bezier playground</a> to get a feel for how different curves affects the feel of an animation.</p>\n<p>A full exploration of easing is a post of its own. But for now let’s make our <code class=\"language-text\">tween</code> capable of accepting different easing functions.</p>\n<p>Add this <code class=\"language-text\">easeOut</code> function to the top of your JavaScript:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">easeOut</span><span class=\"token punctuation\">(</span>progress<span class=\"token punctuation\">,</span> power <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token number\">1</span> <span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">-</span> progress<span class=\"token punctuation\">)</span> <span class=\"token operator\">**</span> power<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>This starts motion fast, and gradually slows over the course of the animation.</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3b3895ac8d0264925e0f21344cc38dd6/8a7aa/201902-easing-ease-out.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 650px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 63.291139240506325%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAABQ0lEQVQ4y31SXVfCMAzd0/4Vf90nXvTFp6JHQUAZnA1wYwjDNR+m3YpdGcs5l4Sb9CZpFzFz7ONS1dcYAGNq4yNBrPQpDuuBqPM/kh/lQETW79NCiVjD0z9vcCJQO6xVAr8KWt7PG8Eby1ZFH80rUTdIJa6434wgOkgn65N5hqABqeVz1Cjr4kG8X++fcbhOKAkLO8ksZa3BxgVqnujTNWc8trU+50/YIctjyU/jZxvX0lwFYmHzvpU7xUWR8/jh0cZvIlbKhKHYkN0IAgIvX754r2v+wObqMZiMgpV7BX3RbLHjSXXkytw39QsN3SE1XGMmnkzXNNNncrkhuDMORhAcZDXr3xcpvC5TyDcFZOscsuQbNp9b2ErsYLjzz8XWU3vOILp7u/IW5j2oxXy65Hx3sF8b1g3uPcrIh3QbhdwQwvo/UE7azM2SP68AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"A graph representing ease out easing\"\n        title=\"\"\n        src=\"/static/3b3895ac8d0264925e0f21344cc38dd6/6b671/201902-easing-ease-out.png\"\n        srcset=\"/static/3b3895ac8d0264925e0f21344cc38dd6/f7a0c/201902-easing-ease-out.png 163w,\n/static/3b3895ac8d0264925e0f21344cc38dd6/608ba/201902-easing-ease-out.png 325w,\n/static/3b3895ac8d0264925e0f21344cc38dd6/6b671/201902-easing-ease-out.png 650w,\n/static/3b3895ac8d0264925e0f21344cc38dd6/1ee70/201902-easing-ease-out.png 975w,\n/static/3b3895ac8d0264925e0f21344cc38dd6/8a7aa/201902-easing-ease-out.png 1264w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n      />\n  </span>\n  </a></p>\n<p>In your <code class=\"language-text\">tween</code> function, make this the default <code class=\"language-text\">ease</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">tween</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">from</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n  to <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n  duration <span class=\"token operator\">=</span> <span class=\"token number\">300</span><span class=\"token punctuation\">,</span>\n  ease <span class=\"token operator\">=</span> easeOut<span class=\"token punctuation\">,</span>\n  onUpdate\n<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></code></pre></div>\n<p>I prefer using this as a default over <code class=\"language-text\">linear</code> because most UI animations should happen as a result of a user’s action. To make it feel like the user is imparting their own energy into the UI, I prefer to start those animations fast and let them slow down on their own.</p>\n<p>If an animation is happening <strong>not</strong> as a direct result of a user’s input, an easing function that starts a little slower is better, to grab the user’s attention before they miss what’s changing.</p>\n<p>To use this <code class=\"language-text\">ease</code> function in our animations we need to replace the <code class=\"language-text\">progress</code> we use in our <code class=\"language-text\">latest</code> calculation with the amended version returned from <code class=\"language-text\">ease</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> latest <span class=\"token operator\">=</span> <span class=\"token keyword\">from</span> <span class=\"token operator\">+</span> <span class=\"token function\">ease</span><span class=\"token punctuation\">(</span>progress<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> delta<span class=\"token punctuation\">;</span></code></pre></div>\n<p>Now the animation feels more natural. Different easing functions work well with different properties, and work well with different <code class=\"language-text\">duration</code>s. Experimentation is the key here.</p>\n<h2 id=\"next-steps\"><a href=\"#next-steps\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Next steps</h2>\n<p>There’s plenty we can do to improve the usability and functionality of our tween function. Here’s some ideas for you to explore:</p>\n<ul>\n<li>Adding support for units, colors and other value types (hint: you can use a function like <a href=\"https://popmotion.io/popcorn/api/interpolate/\">Popcorn’s <code class=\"language-text\">interpolate</code></a>)</li>\n<li>Return an API with methods like <code class=\"language-text\">pause</code>, <code class=\"language-text\">resume</code>, <code class=\"language-text\">stop</code> and <code class=\"language-text\">seek</code>. How do these affect our choice of calculating <code class=\"language-text\">elapsed</code>?</li>\n</ul>","frontmatter":{"title":"Learn how a tween animations work by building one","date":"04 Mar 2019"},"fields":{"slug":"/20190224-how-to-write-a-tween/","author":"mattperry","description":"The best way to learn something is by doing. In this post we'll learn how a duration-based tween animation works by writing one together."}}},"pageContext":{"slug":"/20190224-how-to-write-a-tween/","author":"mattperry","description":"The best way to learn something is by doing. In this post we'll learn how a duration-based tween animation works by writing one together."}}